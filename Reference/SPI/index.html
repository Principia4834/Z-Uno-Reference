<h1>SPI</h1>
<span class="function_description">
    <br>Serial Peripheral Interface (SPI) is a synchronous serial data protocol used by microcontrollers for communicating with one or more peripheral devices quickly over short distances. It can also be used for communication between two microcontrollers. </br>
    <br>With an SPI connection there is always one master device (usually a microcontroller) which controls the peripheral devices. Typically there are three lines common to all the devices:</br>
<ul>
<li>MISO (Master In Slave Out) &mdash; The Slave line for sending data to the master</li>
<li>MOSI (Master Out Slave In) &mdash; The Master line for sending data to the peripherals</li>
<li>SCK (Serial Clock) &mdash; The clock pulses which synchronize data transmission generated by the master</li>
<li>CS/SS (Slave Select or Chips Select) &mdash; the pin on each device that the master can use to enable and disable specific devices.</li>
</ul>
<span>

<span zunoVersion="v1"></span>

<span zunoVersion="v2" class="function_description_more">Z-Uno 2 board have the following SPI interfaces:
	<ul>
		<li>SPI0 &mdash; UART on SCK(0), MISO(1) and MOSI(2) pins</li>
		<li>SPI(SPI1) &mdash; UART on SCK(0) and MISO(1), MOSI(2) pins</li>
		<li>SPI2 &mdash; UART on SCK2(3), MISO2(4) and MOSI2(7) pins</li>
	</ul>
</span>

<span class="function_description_more">
For more infomation about pins of Z-Uno <a href="http://z-uno.z-wave.me/technical/pinout/">here</a>
</span>

<span class="function_description_more">
When a device's Slave Select pin is low, it communicates with the master. When it's high, it ignores the master. This allows you to have multiple SPI devices sharing the same MISO, MOSI, and CLK lines.<br/>
To write code for a new SPI device you need to note a few things:
<ul>
<li>What is the maximum SPI speed your device can use? This is controlled by the first parameter in SPISettings. Z-Uno supports up to 8MHz (8000000). Z-Uno will automatically use the best speed that is equal to or less than the number you use with SPISettings.</li>
<li>Is data shifted in Most Significant Bit (MSB) or Least Significant Bit (LSB) first? This is controlled by second SPISettings parameter, either MSBFIRST or LSBFIRST. Most SPI chips use MSB first data order.</li>
<li>Is the data clock idle when high or low? Are samples on the rising or falling edge of clock pulses? These modes are controlled by the third parameter in SPISettings.</li>
</ul>
The SPI standard is loose and each device implements it a little differently. This means you have to pay special attention to the device's datasheet when writing your code.
<br>Once you have your SPI parameters, use SPI.beginTransaction() to begin using the SPI port.
</span>
<span class="function_example"><code class="c"><pre>
SPISettings spi_settings = SPISettings(8000000, MSBFIRST, SPI_MODE0);
SPI.beginTransaction(&amp;spi_settings);
// ...
SPI.endTransaction();
</pre></code></span>
<span class="function_description_more">
The SPI settings are applied at the beginning of the transaction and <span class="function_ref" link="SPI/EndTransaction">endTransaction</a>()</span> doesn't change SPI settings. Unless you, or some library, 
calls beginTransaction a second time, the setting are maintained. You should attempt to minimize the time between before you call <span class="function_ref" link="SPI/EndTransaction">endTransaction</a>()</span>, 
for best compatibility if your program is used together with other libraries which use SPI.
With most SPI devices, after SPI.beginTransaction(), you will write the slave select pin LOW, call <span class="function_ref" link="SPI/Transfer">transfer</a>()</span> any number of times to transfer data, then write the SS pin HIGH, and finally call <span class="function_ref" link="SPI/EndTransaction">endTransaction</a>()</span>.
</span>

<span class="function_description_note" zunoVersion="v2">
Note that SPI uses one <b>DMA channel</b>.
</span>

<span class="function_description_reference">
<ul>
    <li><a href="/Reference/SPI/SPISettings/">SPISettings</a></li>
	<li><a href="/Reference/SPI/Begin">begin</a></li>
	<li><a href="/Reference/SPI/End">end</a></li>
	<li><a href="/Reference/SPI/BeginTransaction">beginTransaction</a></li>
	<li><a href="/Reference/SPI/EndTransaction">endTransaction</a></li>
	<li><a href="/Reference/SPI/setBitOrder" zunoVersion="v2">setBitOrder</a></li>
	<li><a href="/Reference/SPI/setBitOrder" zunoVersion="v2">setClockDivider</a></li>
	<li><a href="/Reference/SPI/setBitOrder" zunoVersion="v2">setDataMode</a></li>
	<li><a href="/Reference/SPI/Transfer">Transfer</a></li>
</ul>
</span>

<span class="function_description_more" zunoVersion="v2">
	Custom pins can be used by calling <span class="function_ref" link="SPI/Begin">begin</a>()</span><br>
	
	The table below shows which pin can be used on which SPI port
	<table>
		<tr>
			<th>Pin #</th>
			<th>SPI0 SCK/MISO/MOSI</th>
			<th>SPI1 SCK/MISO/MOSI</th>
			<th>SPI2 SCK/MISO/MOSI</th>
			<th>SS</th>
		</tr>
		<tr>
			<td>0</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>1</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>2</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
			<td>3</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>4</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>5</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>6</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>7</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>8</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
		</tr>
			<td>9</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>10</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>11</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>12</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>13</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>14</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
			<td>15</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>16</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>17</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>18</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>19</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>20</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
			<td>21</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>22</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>23</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>24</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
		<tr>
			<td>25</td>
			<td style="color: green;">✔</td>
			<td style="color: green;">✔</td>
			<td style="color: red;">✘</td>
			<td style="color: green;">✔</td>
		</tr>
	</table>
</span>

<span class="function_description_note" zunoVersion="v2">
Note that SPI and UART use shared peripherals. Only one can work at the same time.
</span>

<span class="function_description_more" zunoVersion="v2">
Shared peripherals
	<table>
		<tr>
			<th>SPI port</th>
			<th>UART port</th>
		</tr>
		<tr>
			<td>SPI0</td>
			<td>USART0</td>
		</tr>
		<tr>
			<td>SPI1</td>
			<td>USART1</td>
		</tr>
		<tr>
			<td>SPI2</td>
			<td>USART2</td>
		</tr>
	</table>
</span>